<!-- new ticket style -->
  <div class="container">
    <h1 class = "h1-white">Trajets commandés</h1>
    <div class="marged-top">
      <div class="col-xs-12 col-md-8">

<!-- new ticket flex box-->
        <div class="card-ticket">
          <div class="card-ticket-image" style="background-image: linear-gradient(135deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.2) 50%), url('<%= cl_image_path "ioosfcxh8uwjz49aikrg" %>');"></div>

          <!-- description -->
          <div class="card-ticket-description">
            <!-- pricing -->
            <div class="card-ticket-price">
              <span class="ticket-price">15€</span>
            </div>
            <!-- information depart -->
            <div class="card-ticket-traject">
              <div class="card-ticket-traject-detail">
                <h2><%= @town %></h2>
                <p><%= @address_passenger %></p>
              </div>
              <div class="card-ticket-traject-hours">
                <span><%= @stop_time %></span>
              </div>
            </div>
            <hr>

            <!-- information arrival -->
            <div class="card-ticket-traject">
              <div class="card-ticket-traject-detail">
                <h2>Vieilles Charrues</h2>
                <p><%= @charrues %></p>
              </div>
              <div class="card-ticket-traject-hours">
                <span><%= @end_time %></span>
              </div>
            </div>
            <hr>

            <!-- information driver -->
            <div class="card-ticket-driver-order">
              <p> <%= image_tag('steering-wheel.png', class: "volant")%> <%= @driver.first_name %> <%= @driver.last_name %> </p>
            </div>

            <!-- status -->
            <div class="card-ticket-status">
              <span class="ticket-status">
              <% if @user_stop.status == "Pending" %>
                <p class="status" style="color:#efb73e">Pending</p>
              <% elsif @user_stop.status == "Refused" %>
                <p class="status" style="color:red">Refused</p>
              <% elsif @user_stop.status == "Accepted"%>
                 <p class="status" style="color:green">Accepted</p>
              <% end %>
              </span>
            </div>
          </div>
        </div>

        <div class="" id="btn-nv-recherche" >
          <i class="fa fa-long-arrow-left" aria-hidden="true"></i><%= link_to "  Nouvelle recherche", root_path, method: :get %>
        </div>
      </div>

  <!-- old traject ticket -->
            <!-- driver and passengers presentation -->
              <!-- <p> <%= @driver.first_name %> <%= @driver.last_name %></p>
                     <p><%= @start_address %></p></em>
                      <p><%= @traject.description %></p>
               <div class="col-xs-12"> <p>PASSAGERS:  Aucun</p> </div>
            </div> -->
          <!-- <div class="col-xs-12 text-center">
           <%# if @user_stop.status == "Pending" %>
            <p class="status" style="color:#efb73e">Pending</p>
          <%# elsif @user_stop.status == "Refused" %>
            <p class="status" style="color:red">Refused</p>
          <%# elsif @user_stop.status == "Accepted"%>
           <p class="status" style="color:green">Accepted</p>
          <%# end %>
          </div> -->

    <!-- Google map traject -->
      <div class="col-xs-12 col-md-4">
        <div id="map-traject-user" style="width: 100%; height: 318px;"></div>
      </div>
    </div>




      <!-- Reviews -->

        <div class="row">
          <div class="col-md-3"></div>
          <div class="col-md-9 reviews-container">
            <div class="col-md-3"></div>
            <div class="col-md-9">
              <h3> Messages </h3>

              <% @reviews.each do |review| %>
                <% if review.user.id == current_user.id %>
                  <%= render 'review-current-user', review: review %>
                <% else %>
                  <%= render 'review-else', review: review %>
                <% end %>
              <% end %>
            </div>
          </div>
        </div>

         <div class="row">
          <div class="col-md-3"></div>
          <div class="col-md-9 form-review">

            <div class="col-md-6">
              <div class="col-md-3"></div>
              <div class="col-md-9">

               <%= simple_form_for([ @traject, @review ], remote: true) do |form| %>
                  <%= form.input :content, as: :text %>
                  <%= form.button :submit %>
                <% end %>
            </div>
            </div>
            <div class="col-md-3"></div>
          </div>
         </div>



    </div>




<% content_for(:after_js1) do %>
  <%= javascript_tag do %>
    $(document).ready(function() {
      $('.ticket-address').textfill({
        maxFontPixels: 14
       });
      $('.ticket-city').textfill({
        maxFontPixels: 37
      });
      var handler = Gmaps.build('Google');
      handler.buildMap({ internal: { id: 'map-traject-user' } }, function() {
        markers = handler.addMarkers(<%= raw @hash.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
        if (markers.length == 0) {
          handler.getMap().setZoom(2);
        } else if (markers.length == 1) {
          handler.getMap().setZoom(14);
        }
      });
    });

  <% end %>
<% end %>
